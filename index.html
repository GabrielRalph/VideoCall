<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <div style = "display: flex; flex-direction: column; gap: 1em;">
      <!-- <button id = "swc">
        Start Webcam
      </button> -->
      <div>
        <button id = "b1">Make session</button>: <input id = "i1" placeholder="SDP" />
      </div>
      <div>
        <button id = "b2">Join as Participant</button>: <input id = "i2" placeholder="SDP" />
      </div>
      <div id = "video-call-element">
        <video autoplay playsinline muted></video>
        <video autoplay playsinline></video>
      </div>
    </div>
  </body>

  <script type = "module">
    import * as VideoCall from "./webrtc.js"
    import * as Webcam from "./Webcam.js"
    let vce = document.getElementById("video-call-element");
    let v1 = vce.children[0];
    let v2 = vce.children[1];
    let swc = document.getElementById("swc");
    let b1 = document.getElementById("b1");
    let b2 = document.getElementById("b2");
    let i1 = document.getElementById("i1");
    let i2 = document.getElementById("i2");

    let signaler = VideoCall.signaler;
    console.log(signaler);



    // VideoCall.setElement(vce);

    b1.onclick = async () => {
      let key = await signaler.make();
      if (await Webcam.startWebcam()) {
        VideoCall.start(v1, v2, Webcam.getStream())
        i1.value = key;
      } else {
        alert("Webcam is not accessible.")
      }
    }
    b2.onclick = async () => {
      if (await Webcam.startWebcam()) {
        let key = i2.value;
        await signaler.join(key, true);
        VideoCall.start(v1, v2, Webcam.getStream());
      } else {
        alert("Webcam is not accessible.")
      }
    }

    // setInterval(() => {
    //   // information from video call stored in video-call-element
    //   console.log(vce.numberOfParticipants);
    // }, 1000)
  </script>
  <style>
    #video-call-element {
      display: flex;
      width: 100%;
    }
    #video-call-element video {
      width: 100%;
    }
  </style>
</html>
