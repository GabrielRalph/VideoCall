<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <div>
      <button id = "swc">
        Start Webcam
      </button>
      <div>
        <button id = "b1">Join as Host</button>: <input id = "i1" />
      </div>
      <div>
        <button id = "b2">Join as Participant</button>: <input id = "i2" />
      </div>
    </div>
    <div id = "video-call-element">

    </div>
  </body>

  <script type = "module">
    import * as VideoCall from "./VideoCall.js"
    import * as Webcam from "./Webcam.js"
    let vce = document.getElementById("video-call-element");
    let swc = document.getElementById("swc");
    let b1 = document.getElementById("b1");
    let b2 = document.getElementById("b2");
    let i1 = document.getElementById("i1");
    let i2 = document.getElementById("i2");

    // Start/stop web camera using Webcam module.
    swc.onclick = async () => {
      if (Webcam.isOn()) {
        Webcam.stopWebcam();
        swc.innerHTML = "Start Webcam";
      } else {
        if (await Webcam.startWebcam()) {
          // Set VideoCall module's media stream
          VideoCall.setStream(Webcam.getStream());
          swc.innerHTML = "Stop Webcam"
        } else {
          alert("Webcam is not accessible.")
        }
      }
    }

    VideoCall.setElement(vce);

    b1.onclick = () => VideoCall.joinAsHost(i1.value);
    b2.onclick = () => VideoCall.joinAsHost(i2.value);

    setInterval(() => {
      // information from video call stored in video-call-element
      console.log(vce.numberOfParticipants);
    }, 1000)
  </script>
</html>
